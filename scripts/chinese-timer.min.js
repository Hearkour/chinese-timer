const e=document.documentElement,t=document.body;function i(e){return document.getElementById(e)}function n(e){return document.querySelector(e)}function s(e){return document.getElementsByClassName(e)[0]}function a(){return getComputedStyle(t).fontSize.slice(0,-2)}function r(){return Math.floor(performance.now()/1e3)}function c(t,i,n){e.style.setProperty(t,i,n)}function o(t){return e.style.getPropertyValue(t)}function l(e){return parseInt(e.substr(1,2),16)+", "+parseInt(e.substr(3,2),16)+", "+parseInt(e.substr(5,2),16)}function d(e){let t=e.split(/[rgb, \(\)]+/).slice(1,4).map(e=>+e),i="#";return t.forEach(e=>{i+=e>9?e.toString(16):"0"+e.toString(16)}),i}function m(e){for(const t of document.getElementsByClassName("wrapper"))e.push(t.id)}function u(e,t){0==t?e.forEach(e=>{i(e).classList.remove("wrapper")}):e.forEach(e=>{i(e).classList.contains("wrapper")||i(e).classList.add("wrapper")})}const p=i("title"),b=i("timer-digits"),h=i("timer-chinese-chars"),f=i("timer-chinese-pinyin"),g=i("div-selectTimeout");g.innerHTML='\n    <abbr title=\'시간 선택\'>\n        <select id="select-setTimeout">\n            <option value="60"          >   1분 </option>\n            <option value="180"         >   3분 </option>\n            <option value="300" selected>   5분 </option>\n        </select>\n    </abbr>\n';const v=i("select-setTimeout"),$=!1,w=[];var k=.2,T="180, 0, 60",y=.25,x=.5,I="calc(var(--case-size) / 1.4)";const S=.4,A=1.1,L=1,E="6vmax";var M;const z="배달의민족 연성";var H,B;const N=1.25,P=1.5,q="9vw",F="solid",W="solid",O=1;var C="6px";function _(){let e=te.getIds().map(e=>e.innerText);return 6e3*e[0]+600*e[1]+60*e[2]+100*e[3]+10*e[4]+1*e[5]}function U(e,t){c("--base-color",`rgb(${T=e})`),c("--wrapper-alpha",`rgba(${T}, ${k})`),t?(c("--btn-setTime-alpha",`rgba(${T}, 1`),c("--btn-alpha",`rgba(${T}, 1)`),c("--border-alpha",`rgba(${T}, 1)`)):(G.editing?c("--btn-setTime-alpha",`rgba(${T}, ${y}`):1==ge.getState()?c("--btn-setTime-alpha",`rgba(${T}, 1`):c("--btn-setTime-alpha",`rgba(${T}, ${x}`),c("--border-alpha",`rgba(${T}, ${ge.getState()})`),1==ge.getState()?(c("--btn-alpha",`rgba(${T}, 1)`),0==be.getState()&&c("--btn-setTime-alpha",`rgba(${T}, 1`)):(c("--btn-alpha",`rgba(${T}, ${x})`),0==be.getState()&&c("--btn-setTime-alpha",`rgba(${T}, ${x}`)))}function j(e){let t;return t="분"!=e&&"초"!=e&&G.getBaseHTML().includes("editTime")?"hue-rotate(1rad) brightness(1.1)":"brightness(0.4)"," "==e&&"0"!=e&&(e="&#8202;"),`<span style="filter: ${t};">${e}</span>`}function V(i,n){let s=i+n,a=e.clientHeight-t.clientHeight;c("--body-margin",`${a*(i/s)}px ${C} ${a*(n/s)}px ${C}`)}function D(t){let i,n=t.split(/[(), ]+/),s=void 0;const a=e.clientWidth,r=e.clientHeight;return n.forEach(e=>{if("min"!=e&&"max"!=e&&""!=e){switch(e.slice(-2)){case"px":i=parseInt(e.slice(0,-2));break;case"vw":i=parseInt(e.slice(0,-2))/100*a;break;case"vh":i=parseInt(e.slice(0,-2))/100*r;break;case"vmin":i=parseInt(e.slice(0,-4))/100*(a<r?a:r);break;case"vmax":i=parseInt(e.slice(0,-4))/100*(a>r?a:r)}(null==s||"min"==n[0]&&s>i||"max"==n[0]&&s<i)&&(s=i)}}),s}const G={class:`class="outer case ${B}"`,style:`style="width: var(--case-size); border-right: none; ${H}"`,editing:!1,drawPaused:!1,isActive:!1,timeout:300,initialTime:0,stoppedTime:0,interval:0,now:0,then:0,remains:0,getBaseHTML:()=>(G.class=`class="outer case ${B}"`,G.style=`style="width: var(--case-size); border-right: none; ${H}"`,G.class+G.style),reset:()=>{G.initialTime=G.stoppedTime=G.interval=0,G.now=0,G.remains=G.timeout}},J={index:{clock:0,timeout:1},clock:[new Audio("fx/sounds/clock0.flac"),new Audio("fx/sounds/clock1.flac"),new Audio("fx/sounds/clock2.flac")],timeout:[new Audio("fx/sounds/timeout0.flac"),new Audio("fx/sounds/timeout1.flac"),new Audio("fx/sounds/timeout2.flac")]};m(w),u(w,$),c("--font-family","배달의민족 연성"),c("--font-size",`min(6vmax, ${M})`),p.innerHTML=j(p.innerHTML),c("--case-size-fixed",1.5*a()+"px"),c("--case-size",`min(${1.5*a()}px, 9vw)`),c("--btn-size",I),c("--case-border-style","solid"),c("--border-style","solid"),U(T,!0),c("--border-thickness",C),c("--font-size-title",1.25*a()+"px"),c("--case-size-title",D(o("--case-size"))+.25*a()+"px");class K{static fpsInterval;static startTime;static now;static then;static elapsed}function Q(e){K.fpsInterval=1e3/e,K.then=performance.now(),K.startTime=K.then,R(),Z()}function R(){K.now=performance.now(),K.elapsed=K.now-K.then,K.elapsed>K.fpsInterval&&(K.then=K.now-K.elapsed%K.fpsInterval,X()),G.drawPaused||requestAnimationFrame(R)}function X(){ie(b,"digits"),ie(h,"chinese","chars"),ie(f,"chinese","pinyin")}function Y(){M=window.innerWidth>1400?window.innerHeight<420?"1.5rem":window.innerHeight<640?"2.5rem":window.innerHeight<780?"3.5rem":"4.5rem":window.innerWidth>1080?"3.5rem":window.innerWidth>840?"3rem":"2.4rem",C=window.innerWidth>840&&window.innerHeight>540?"5px":"3px"}function Z(){Y(),V(1,1.618),c("--font-size",`min(6vmax, ${M})`),c("--case-size",`min(${1.5*a()}px, 9vw)`),c("--border-thickness",C),c("--font-size-title",1.25*a()+"px"),c("--case-size-title",D(o("--case-size"))+.25*a()+"px"),requestAnimationFrame(Z)}Q(5);const ee={c:function(e){let t="";switch(e){case 0:t="零";break;case 1:t="一";break;case 2:t="二";break;case 3:t="三";break;case 4:t="四";break;case 5:t="五";break;case 6:t="六";break;case 7:t="七";break;case 8:t="八";break;case 9:t="九";break;case 10:t="十"}return t},p:function(e){let t="";switch(e){case 0:t="líng";break;case 1:t="yī";break;case 2:t="èr";break;case 3:t="sān";break;case 4:t="sì";break;case 5:t="wǔ";break;case 6:t="liù";break;case 7:t="qī";break;case 8:t="bā";break;case 9:t="jiǔ";break;case 10:t="shí"}return t}},te={m3:0,m2:0,m1:0,s3:0,s2:0,s1:0,getIds:function(){return[i("m3"),i("m2"),i("m1"),i("s3"),i("s2"),i("s1")]},convertTo:e=>{"chars"==e?(te.m3=ee.c(te.m3),te.m2=ee.c(te.m2),te.m1=ee.c(te.m1),te.s3=ee.c(te.s3),te.s2=ee.c(te.s2),te.s1=ee.c(te.s1)):"pinyin"==e&&(te.m3=ee.p(te.m3),te.m2=ee.p(te.m2),te.m1=ee.p(te.m1),te.s3=ee.p(te.s3),te.s2=ee.p(te.s2),te.s1=ee.p(te.s1))}};function ie(e,t,i){G.isActive?(G.initialTime||(G.initialTime=r()),G.now=r()-G.initialTime,G.then!=G.now&&G.remains>0&&(G.then=G.now,J.clock[J.index.clock].play())):G.initialTime&&(G.interval=r()-G.stoppedTime),G.remains=G.timeout-G.now,G.remains<1&&(G.then=G.remains=0,G.isActive&&(J.timeout[J.index.timeout].play(),ce.click())),ne(e,t,i,Math.floor(G.remains/60),Math.floor(G.remains%60))}function ne(e,t,i,n,s){se(t,n,s),ae(e,t,i)}function se(e,t,i){"digits"==e?(te.m3=te.s3=" ",te.m2=t<10?" ":Math.floor(t/10),te.s2=i<10?" ":Math.floor(i/10),te.m1=Math.floor(t%10),te.s1=Math.floor(i%10)):"chinese"==e&&(se("digits",t,i),te.m3=te.m2>1?te.m2:"",te.s3=te.s2>1?te.s2:"",te.m2=te.m2>0?10:"",te.s2=te.s2>0?10:"",te.m2>0&&0==te.m1&&(te.m1=""),te.s2>0&&0==te.s1&&(te.s1=""))}function ae(e,t,i){let n,s,a="";H=B="","digits"==t?(n="분",s="초",H="font-family: simsun; font-weight: bold;",a=`contenteditable="${G.editing}"`,B=G.editing?"editTime":""):"chinese"==t&&("chars"==i?(te.convertTo("chars"),n="分",s="秒",e.style.fontFamily="kaiti"):"pinyin"==i&&(te.convertTo("pinyin"),n="fēn",s="miǎo",e.style.fontFamily="NotoSerif-Medium"));let r=G.getBaseHTML();e.innerHTML=`\n        <div class="outer">\n            <div id="m3"             ${r}>   ${j(te.m3)}   </div>\n            <div id="m2" ${a} ${r}>   ${j(te.m2)}   </div>\n            <div id="m1" ${a} ${r}>   ${j(te.m1)}   </div>\n            <div ${r.split("font")[0]}">     ${j(n)} </div>\n            <div ${r.split("font")[0]}">                             </div>\n            <div id="s3"             ${r}>   ${j(te.s3)}   </div>\n            <div id="s2" ${a} ${r}>   ${j(te.s2)}   </div>\n            <div id="s1" ${a} ${r}>   ${j(te.s1)}   </div>\n            <div ${r.split("border")[0]}">   ${j(s)} </div>\n        </div>\n    `}const re=i("btn-setTimeout"),ce=i("btn-timer"),oe=i("btn-resetTime"),le=i("btn-border"),de=i("btn-color"),me=i("btn-wrapper");var ue=!1;class pe{constructor(e,t,i=null,n=i,s=null,a=null){this.$btnId=e,this.description=t,this.states=[i,n],this.iconName=[s,a],this.i=0,"UNSET"!=i&&this.setupBtn()}doclick(){return this.switchState(),this.setupBtn(),this.i}switchState(){return this.i=this.i?0:1}getState(){return this.states[this.i]}getIconName(){return null==this.iconName[0]?""+this.$btnId.id:`${this.$btnId.id}-${this.iconName[this.i]}`}setupBtn(){this.$btnId.innerHTML=`\n            <abbr title='${this.description}'>\n                <svg>\n                    <use xlink:href="icons/min/${this.getIconName()}.svg#레이어_1"></use>\n                </svg>\n            </abbr>\n        `}}var be=new pe(re,"시간 설정",!1,!0,"edit","resume"),he=new pe(ce,"타이머 시작/일시 정지",G.isActive,!0,"start","stop"),fe=new pe(oe,"타이머 초기화",G.timeout),ge=new pe(le,"윤곽선 숨기기/보이기",1,0,"none","solid"),ve=new pe(de,"색 선택","UNSET"),$e=new pe(me,"모서리 모양",$,!0,"wrap","nowrap");function we(){i("cpOuter").style.fill=i("colorpicker").value,i("cpOuter").style.filter="brightness(100%)",i("cpInner").style.fill=i("colorpicker").value,i("cpInner").style.filter="brightness(0.4)",ue?requestAnimationFrame(we):(i("cpOuter").removeAttribute("style"),i("cpInner").removeAttribute("style"))}ve.setupBtn=()=>{ve.$btnId.innerHTML=`\n        <abbr title='${ve.description}'>\n            <div style="position: relative; display: inline-block;">\n                <input id="colorpicker" type="color" value="${d(o("--base-color"))}">\n                <label for="colorpicker">\n                    <svg id="cpOuter" class="outer">\n                        <use xlink:href="icons/min/btn-color-outer.svg#레이어_1"></use>\n                    </svg>\n                    <svg id="cpInner" class="inner">\n                        <use xlink:href="icons/min/btn-color-inner.svg#레이어_1"></use>\n                    </svg>\n                </label>\n            </div>\n        </abbr>\n    `},ve.setupBtn(),re.addEventListener("click",(function(){be.doclick(),G.editing=be.getState(),G.editing?(c("--btn-setTime-alpha",`rgba(${T}, ${y}`),G.isActive&&ce.click(),X(),G.drawPaused=!0):(1==ge.getState()?c("--btn-setTime-alpha",`rgba(${T}, 1`):c("--btn-setTime-alpha",`rgba(${T}, ${x}`),G.timeout=_(),G.reset(),X()),G.remains<1&&(G.remains=G.timeout)})),ce.addEventListener("click",(function(){G.editing&&(G.remains=_()),(G.remains>0||G.isActive)&&(he.doclick(),G.isActive=he.getState()),G.isActive?(1==be.getState()&&re.click(),G.initialTime+=G.interval,G.drawPaused&&(G.drawPaused=!1,R())):G.stoppedTime=r()})),oe.addEventListener("click",(function(){G.reset()})),le.addEventListener("click",(function(){ge.doclick(),c("--border-alpha",`rgba(${T}, ${ge.getState()})`),1==ge.getState()?(c("--btn-alpha",`rgba(${T}, 1)`),0==be.getState()&&c("--btn-setTime-alpha",`rgba(${T}, 1`)):(c("--btn-alpha",`rgba(${T}, ${x})`),0==be.getState()&&c("--btn-setTime-alpha",`rgba(${T}, ${x}`))})),de.addEventListener("click",(function(){ue=!0,we()})),i("colorpicker").addEventListener("change",(function(){ue=!1,U(l(i("colorpicker").value))})),me.addEventListener("click",(function(){$e.doclick(),console.log($e.getState()),u(w,$e.getState())})),v.addEventListener("change",(function(){1==be.getState()&&re.click(),G.isActive&&ce.click(),G.timeout=parseInt(v.value),G.reset(),X()}));